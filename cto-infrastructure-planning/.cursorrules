# CTO 基礎設施規劃 - 配置參數

## 專案概況
- **公司性質**: 新創公司（2024年5月開始）
- **業務模式**: 母集團支持，外包開發後內部維護運營
- **主要產品**: 
  1. 互動式直播（白產）
  2. Video（影視站 + 色站，黑產）
  3. 賽事投注（H5 嵌入 IM App）

## 關鍵時間點
- **賽事 2.0**: 2025年1月初驗收
- **賽事部署**: 2025年1月中上線
- **直播專案**: 進度延遲，暫緩處理

## 現有基礎設施配置

### 硬體資源（待確認具體規格）
```yaml
# 地端機器清單
mac_mini_servers:
  - count: 3
    spec: "待補充（CPU/RAM/Storage）"
    usage: "影視相關內容，已接近飽和"
    os: "macOS (ARM64)"

windows_servers:
  - count: "數台（待確認）"
    spec: "待補充"
    usage: "部分服務"
    os: "Windows"
    issue: "導致架構碎片化（x86 vs ARM64）"

other_servers:
  - gitlab: "VM 經常因資源不足被關閉"
```

### 環境配置
```yaml
environments:
  白產_直播:
    - dev: "地端"
    - stg: "地端"
    - prd: "地端（未來）"
    
  黑產_影視站:
    - dev: "地端"
    - stg: "地端"
    - prd: "雲端（現階段）"
    
  黑產_色站:
    - dev: "地端"
    - stg: "地端"
    - prd: "雲端（現階段）"
    
  賽事:
    - dev: "地端（1月中需部署）"
    - stg: "地端（1月中需部署）"
    - prd: "待定"
```

### K8s 配置
```yaml
k8s_deployment:
  tool: "Kubernetes"
  cicd: "Jenkins"
  registry: "Harbor"
  
current_issues:
  - "dev 環境運行正常"
  - "stg 環境資源耗盡（異常）"
  - "資源限制配置可能不當"
  - "可能存在記憶體洩漏"
  - "可能遭受攻擊"
```

## 技術棧

### 後端
```yaml
languages:
  - Java: "主要語言之一"
  - PHP: "主要語言之一"
  
concerns:
  - "Java/PHP 相對吃資源"
  - "可能存在程式碼品質問題"
  - "記憶體洩漏風險"
```

### 前端
```yaml
tech: "待確認（Vue/React？）"
deployment: "H5 嵌入 IM App"
```

## 流量數據（待補充）

```yaml
# 需要收集的數據
traffic_metrics:
  current_qps: "待測量"
  concurrent_users: "待測量"
  video_bandwidth: "很高（影視內容流量大）"
  peak_traffic: "待測量"
  
estimated_growth:
  - "賽事上線後預期增長: 待評估"
  - "直播上線後預期增長: 待評估"
```

## GT 提議方案

```yaml
gt_proposal:
  spec:
    cpu: "100核心"
    memory: "300GB"
    storage: "5TB"
  price_per_unit: "40萬 TWD"
  quantity: 3
  total: "120萬 TWD"
  rationale: "高可用架構（3節點，任一故障不影響服務）"
  
  # 可能的硬體配置（推測）
  possible_config:
    cpu_option_1: "2× AMD EPYC 7713 (64核×2=128核，可能降頻到100核)"
    cpu_option_2: "2× AMD EPYC 7643 (48核×2=96核)"
    cpu_option_3: "2× Intel Xeon Platinum 8360Y (36核×2=72核+超線程=144線程)"
    note: "100核可能指物理核心或邏輯線程，需確認"
  
concerns:
  - "初期投入過大（120萬）"
  - "預算難一次到位"
  - "是否過度設計？"
  - "100核配置是否必要？"
```

## 團隊能力評估

```yaml
team_status:
  video_team: "有能力重構外包代碼，團隊 OK"
  sports_team: "正在組建中"
  live_team: "外包品質差，團隊能力不足"
  
k8s_expertise:
  level: "中等（介於 A-B）"
  note: "CTO 本週末會加強學習以評估團隊能力"
```

## 預算與決策

```yaml
budget_situation:
  status: "公司未盈利，預算有限"
  boss_attitude: "需要詳細計劃書才好申請"
  strategy: "階段性採購 + 技術優化並行"
  
decision_framework:
  - "短期救急（1月中前）"
  - "中期穩定（Q1-Q2）"
  - "長期規劃（H1）"
```

## 核心問題清單

### P0 - 緊急（1月前必須解決）
1. STG 環境資源耗盡根因分析
2. 賽事部署的資源規劃
3. 至少採購 1 台伺服器救急

### P1 - 重要（Q1 解決）
1. GitLab 遷雲或優化
2. 架構碎片化問題（ARM64 vs x86）
3. K8s 資源配置優化
4. 監控系統建立

### P2 - 重要但不緊急（Q2 解決）
1. HA 架構完善
2. 備援機制
3. 容量規劃流程

## 文檔更新指引

當獲得新資訊時，請更新此文件中的對應章節：
- 硬體規格 → 更新 `硬體資源` 區塊
- 流量數據 → 更新 `流量數據` 區塊
- 預算變動 → 更新 `預算與決策` 區塊
- 團隊變化 → 更新 `團隊能力評估` 區塊

所有分析文檔都會引用此配置文件中的數據。

---
**最後更新**: 2024-12-25
**維護者**: CTO

