â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ğŸ”§ ç«¯å£æ˜ å°„å•é¡Œä¿®å¾©ç¸½çµ
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## âŒ å•é¡Œç¾è±¡

åŒäº‹å ±å‘Šï¼š
1. âœ… OpenVPN é¡¯ç¤ºå·²é€£æ¥
2. âŒ æ²’æœ‰æµé‡
3. âŒ test.dev ç„¡æ³•è¨ªå•

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## ğŸ” æ ¹æœ¬åŸå› 

### é…ç½®ä¸ä¸€è‡´

**Pritunl Server é…ç½®ï¼š**
- Port: 11009/udp âœ…

**Docker ç«¯å£æ˜ å°„ï¼ˆä¿®å¾©å‰ï¼‰ï¼š**
```yaml
ports:
  - "9700:443"       # Web GUI
  - "1194:1194/udp"  # âŒ éŒ¯èª¤ï¼æ˜ å°„äº† 1194
  - "1194:1194/tcp"
```

**å®¢æˆ¶ç«¯é…ç½®æ–‡ä»¶ï¼š**
```
remote 192.168.68.106 11009 udp  # âœ… æ­£ç¢º
```

### å•é¡Œåˆ†æ

```
å®¢æˆ¶ç«¯å˜—è©¦é€£æ¥ â†’ 192.168.68.106:11009
                    â†“
                Host Machine (ä½ çš„é›»è…¦)
                    â†“
                âŒ Docker æ²’æœ‰æ˜ å°„ 11009 ç«¯å£
                âŒ åªæ˜ å°„äº† 1194 ç«¯å£
                    â†“
                é€£æ¥å¤±æ•— / ç„¡æµé‡
```

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## âœ… ä¿®å¾©æ–¹æ¡ˆ

### 1. ä¿®æ”¹ docker-compose.yml

```yaml
# ä¿®å¾©å¾Œ
ports:
  - "9700:443"         # Web GUI (HTTPS)
  - "11009:11009/udp"  # âœ… OpenVPN Server Port (æ­£ç¢ºæ˜ å°„)
  - "1194:1194/udp"    # OpenVPN Default Port (å‚™ç”¨)
  - "1194:1194/tcp"    # OpenVPN TCP Port (å‚™ç”¨)
```

### 2. é‡å•Ÿå®¹å™¨

```bash
cd /Users/mike/Documents/self/interview-demo/vpn-server/docker/pritunl
docker-compose down
docker-compose up -d
```

### 3. é©—è­‰ç«¯å£

```bash
netstat -an | grep 11009
# è¼¸å‡º: udp46  0  0  *.11009  *.*
```

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## ğŸ“‹ é…ç½®æ–‡ä»¶æ˜¯å¦éœ€è¦é‡æ–°ä¸‹è¼‰ï¼Ÿ

### âŒ **ä¸éœ€è¦é‡æ–°ä¸‹è¼‰ï¼**

### åŸå› ï¼š

âœ… **é…ç½®æ–‡ä»¶å…§å®¹æ²’æœ‰æ”¹è®Š**

- åœ°å€ï¼š`192.168.68.106:11009`ï¼ˆæ²’è®Šï¼‰
- DNS Serverï¼š`172.25.0.2`ï¼ˆæ²’è®Šï¼‰
- Routesï¼šåŒ…å« DNS Server è·¯ç”±ï¼ˆæ²’è®Šï¼‰
- è­‰æ›¸å’Œå¯†é‘°ï¼šæ²’æœ‰æ”¹è®Š

âœ… **åªæ˜¯ä¼ºæœå™¨ç«¯çš„ Docker é…ç½®ä¿®å¾©äº†**

ä¹‹å‰çš„é…ç½®æ–‡ä»¶æœ¬ä¾†å°±æ˜¯æ­£ç¢ºçš„ï¼Œåªæ˜¯ Docker ç«¯å£æ²’æ˜ å°„å°ï¼Œå°è‡´ç„¡æ³•é€£æ¥ã€‚

ç¾åœ¨ Docker ç«¯å£å·²ç¶“ä¿®å¾©ï¼Œ**åŸæœ¬çš„é…ç½®æ–‡ä»¶å¯ä»¥ç›´æ¥ä½¿ç”¨**ã€‚

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## ğŸ“ åŒäº‹éœ€è¦åšä»€éº¼ï¼Ÿ

### 1ï¸âƒ£ æ–·é–‹ä¸¦é‡æ–°é€£æ¥

**Mac (Tunnelblick):**
```
1. é»æ“Š Tunnelblick åœ–æ¨™
2. Disconnect
3. ç­‰å¾… 3-5 ç§’
4. Connect
```

**Windows (OpenVPN GUI):**
```
1. å³éµ OpenVPN åœ–æ¨™
2. Disconnect
3. ç­‰å¾… 3-5 ç§’
4. Connect
```

### 2ï¸âƒ£ é©—è­‰é€£æ¥

**A. æª¢æŸ¥ VPN IPï¼š**
```bash
# Mac/Linux
ifconfig | grep "inet.*192.168.219"

# Windows
ipconfig | findstr 192.168.219
```
æ‡‰è©²çœ‹åˆ°é¡ä¼¼ï¼š`inet 192.168.219.6 netmask 0xffffff00`

**B. Ping VPN Gatewayï¼š**
```bash
ping 192.168.219.1
```
æ‡‰è©²èƒ½æˆåŠŸ ping é€šï¼Œå»¶é²å¾ˆä½ï¼ˆ< 5msï¼‰

**C. æ¸¬è©¦ DNS è§£æï¼š**
```bash
nslookup test.dev
```
æ‡‰è©²è¿”å›ï¼š
```
Server:		172.25.0.2
Address:	172.25.0.2#53

Name:	test.dev
Address: 119.8.53.204
```

**D. æ¸¬è©¦è¨ªå•ï¼š**
```bash
# Ping è‡ªè¨‚åŸŸå
ping test.dev

# å¦‚æœ 119.8.53.204 æœ‰æœå‹™åœ¨é‹è¡Œ
curl http://test.dev
```

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## ğŸ› å¦‚æœé‚„æ˜¯ä¸è¡Œï¼Ÿ

### æª¢æŸ¥æ¸…å–®ï¼š

### 1ï¸âƒ£ ç¢ºèªé…ç½®æ–‡ä»¶åœ°å€

è§£å£“ `.tar` å¾Œï¼Œæ‰“é–‹ `.ovpn` æ–‡ä»¶ï¼ŒæŸ¥æ‰¾ï¼š

```
remote 192.168.68.106 11009 udp
```

å¦‚æœ**ä¸æ˜¯**é€™å€‹åœ°å€ â†’ éœ€è¦é‡æ–°ä¸‹è¼‰é…ç½®æ–‡ä»¶

### 2ï¸âƒ£ ç¢ºèªç¶²è·¯ç’°å¢ƒ

```bash
# ä½ çš„ IPï¼ˆVPN Serverï¼‰
192.168.68.106

# åŒäº‹çš„ IP æ‡‰è©²ä¹Ÿåœ¨åŒä¸€å€‹ç¶²æ®µ
ping 192.168.68.106
```

å¦‚æœ ping ä¸é€š â†’ ä¸åœ¨åŒä¸€å€‹å…§ç¶²

### 3ï¸âƒ£ æª¢æŸ¥é˜²ç«ç‰†

**ä½ çš„é›»è…¦ï¼ˆMacï¼‰ï¼š**
```
ç³»çµ±è¨­å®š â†’ ç¶²è·¯ â†’ é˜²ç«ç‰†
ç¢ºèªï¼š
- å…è¨±å‚³å…¥é€£æ¥
- æˆ–è€…é—œé–‰é˜²ç«ç‰†æ¸¬è©¦
```

**åŒäº‹çš„é›»è…¦ï¼š**
- Mac: åŒä¸Š
- Windows: æ§åˆ¶å° â†’ Windows Defender é˜²ç«ç‰† â†’ å…è¨±æ‡‰ç”¨é€šéé˜²ç«ç‰†

### 4ï¸âƒ£ æª¢æŸ¥ VPN Server ç‹€æ…‹

åœ¨ä½ çš„é›»è…¦ä¸Šï¼š
```bash
cd /Users/mike/Documents/self/interview-demo/vpn-server/docker/pritunl
docker-compose ps
```

ç¢ºèªæ‰€æœ‰å®¹å™¨éƒ½æ˜¯ `Up` ç‹€æ…‹ï¼š
```
pritunl           Up (healthy)
pritunl-mongodb   Up (healthy)
pritunl-dns       Up (healthy)
```

### 5ï¸âƒ£ æŸ¥çœ‹ Pritunl æ—¥èªŒ

è¨ªå•ï¼šhttps://localhost:9700/#/servers

åœ¨ "Server Output" ä¸­æ‡‰è©²èƒ½çœ‹åˆ°ï¼š
```
[xenon-xxxx] ... Initialization Sequence Completed
```

ç•¶åŒäº‹é€£æ¥æ™‚ï¼Œæœƒçœ‹åˆ°ï¼š
```
[xenon-xxxx] ... CLIENT_ESTABLISHED
```

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## ğŸ¯ é æœŸçµæœ

åŒäº‹é‡æ–°é€£æ¥å¾Œæ‡‰è©²ï¼š

âœ… OpenVPN é¡¯ç¤ºã€Œå·²é€£æ¥ã€
âœ… ç²å¾— VPN IPï¼š192.168.219.x
âœ… å¯ä»¥ ping é€š 192.168.219.1
âœ… DNS è§£æ test.dev â†’ 119.8.53.204
âœ… å¯ä»¥è¨ªå• test.devï¼ˆå¦‚æœè©² IP æœ‰æœå‹™ï¼‰

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## ğŸ“Š æŠ€è¡“ç´°ç¯€

### ç¶²è·¯æ‹“æ¨¸

```
åŒäº‹çš„é›»è…¦ (192.168.68.x)
    â†“
    OpenVPN Client (192.168.219.6)
    â†“
    [åŠ å¯†éš§é“] UDP 11009
    â†“
ä½ çš„é›»è…¦ (192.168.68.106)
    â†“
    Docker (ç«¯å£æ˜ å°„ 11009:11009)
    â†“
    Pritunl Container (172.25.0.4:11009)
    â†“
    VPN Gateway (192.168.219.1)
    â†“
    dnsmasq DNS Server (172.25.0.2)
```

### DNS è§£ææµç¨‹

```
1. åŒäº‹çš„é›»è…¦æŸ¥è©¢ test.dev
2. OpenVPN æ¨é€ DNS Server: 172.25.0.2
3. DNS æŸ¥è©¢é€šé VPN éš§é“ç™¼é€åˆ° 172.25.0.2
4. dnsmasq å›æ‡‰: 119.8.53.204
5. åŒäº‹çš„é›»è…¦æ”¶åˆ°è§£æçµæœ
```

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## ğŸ“ ç¸½çµ

| é …ç›® | ç‹€æ…‹ | èªªæ˜ |
|------|------|------|
| **å•é¡Œ** | âœ… å·²ä¿®å¾© | Docker ç«¯å£æ˜ å°„å·²å°é½Š |
| **é…ç½®æ–‡ä»¶** | âœ… ä¸éœ€é‡æ–°ä¸‹è¼‰ | å…§å®¹æ²’æœ‰æ”¹è®Š |
| **åŒäº‹æ“ä½œ** | ğŸ”„ é‡æ–°é€£æ¥ | æ–·é–‹å¾Œé‡æ–°é€£æ¥å³å¯ |
| **DNS è§£æ** | âœ… å·²é…ç½® | test.dev â†’ 119.8.53.204 |
| **VPN Server** | âœ… æ­£å¸¸é‹è¡Œ | Port 11009/udp |

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ä¿®å¾©æ™‚é–“ï¼š2025-12-19 13:28
Docker Compose ç‰ˆæœ¬ï¼šå·²æ›´æ–°
Pritunl ç‰ˆæœ¬ï¼šv1.32.4469.94

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
